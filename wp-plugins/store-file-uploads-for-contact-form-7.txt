{"name":"Store file uploads for Contact Form 7","slug":"store-file-uploads-for-contact-form-7","version":"1.2.2","author":"Mircea N.","author_profile":"https:\/\/profiles.wordpress.org\/mirceatm\/","contributors":{"mirceatm":{"profile":"https:\/\/profiles.wordpress.org\/mirceatm\/","avatar":"https:\/\/secure.gravatar.com\/avatar\/9622767608e6a79006cdd3af22817791?s=96&d=monsterid&r=g","display_name":"mirceatm"}},"requires":"4.9","tested":"5.9.8","requires_php":false,"requires_plugins":[],"rating":100,"ratings":{"5":6,"4":0,"3":0,"2":0,"1":0},"num_ratings":6,"support_threads":1,"support_threads_resolved":1,"active_installs":1000,"last_updated":"2022-03-19 9:11am GMT","added":"2020-02-28","homepage":"https:\/\/namir.ro\/store-file-uploads-for-contact-form-7\/","sections":{"description":"<p>By default, <a href=\"https:\/\/wordpress.org\/plugins\/contact-form-7\/\" rel=\"ugc\">Contact Form 7<\/a> dose not keep data it sends trough it&#8217;s contact forms.<br \/>\nWhile plugins like <a href=\"https:\/\/wordpress.org\/plugins\/flamingo\/\" rel=\"ugc\">Flamingo<\/a> save that data,  uploaded files are not added to Media Library.<br \/>\nThis plugin will save uploaded files to Media Library before email is sent by CF7.<br \/>\nThis plugin will raise an event with the the full file path &amp; name.<br \/>\nSubscribe to <code>nmr_create_attachment_file_name<\/code> filter to get and\/or update data before attachment is added to media library.<\/p>\n<pre><code>\/\/ The filter callback function.\nfunction example_callback( $file_name ) {\n    \/\/ (maybe) modify $file_name.\n    return $file_name;\n}\nadd_filter( 'nmr_create_attachment_file_name', 'example_callback', 10, 1 );\n<\/code><\/pre>\n<p>Subscribe to <code>nmr_before_insert_attachment<\/code> filter to be able to change attachment attributes:  caption and description are \u2018post_excerpt\u2019 and \u2018post_content\u2019.<br \/>\nFor other attributes, check documentation for <a href=\"https:\/\/developer.wordpress.org\/reference\/functions\/wp_insert_attachment\/\" rel=\"nofollow ugc\">wp_insert_attachment<\/a>.<\/p>\n<pre><code>\/\/ The filter callback function.\nfunction before_insert_attachment_callback( $attachment ) {\n    \/\/ (maybe) modify $attachment array.\n    return $attachment;\n}\nadd_filter( 'before_insert_attachment_callback', 'example_callback', 10, 1 );\n<\/code><\/pre>\n<p>This plugin will send the final attachment id if you are interested in getting other details, like attachment url.<br \/>\nListen to <code>nmr_create_attachment_id_generated<\/code> action.<\/p>\n<pre><code>\/\/ The action callback function.\nfunction example_callback_id_generated( $attachment_id ) {\n    \/\/ (maybe) do something with the args.\n    $url = wp_get_attachment_url( $attachment_id );\n}\nadd_action( 'nmr_create_attachment_id_generated', 'example_callback_id_generated', 10, 1 );\n<\/code><\/pre>\n<h4>Docs &amp; Support<\/h4>\n<p>Check the <a href=\"https:\/\/wordpress.org\/support\/plugin\/store-file-uploads-for-contact-form-7\/\" rel=\"ugc\">support forum<\/a> on WordPress.org. If you can&#8217;t locate any topics that pertain to your particular issue, post a new topic for it.<\/p>\n<h4>Store file uploads for Contact Form 7 Needs Your Support<\/h4>\n<p>It is hard to continue development and support for this free plugin without contributions from users like you. If you enjoy using -Store file uploads for Contact Form 7- and find it useful, please consider <a href=\"https:\/\/paypal.me\/mirceatm\" rel=\"nofollow ugc\"><strong>making a donation<\/strong><\/a>. Your donation will help encourage and support the plugin&#8217;s continued development and better user support.<\/p>\n<h4>Privacy Notices<\/h4>\n<p>With the default configuration, this plugin, in itself, does not:<\/p>\n<ul>\n<li>track users by stealth;<\/li>\n<li>write any user personal data to the database;<\/li>\n<li>send any data to external servers;<\/li>\n<li>use cookies.<\/li>\n<\/ul>\n<p>It will, however store uploaded files trough Contact Form 7 in WordPress Media Library.<br \/>\nMake sure your website users are aware of this fact!!!<\/p>\n","installation":"<ol>\n<li>Upload the entire  folder to the <code>\/wp-content\/plugins\/<\/code> directory.<\/li>\n<li>Activate the plugin through the &#8216;Plugins&#8217; menu in WordPress.<\/li>\n<\/ol>\n<p>After that check Media Library for uploaded files.<\/p>\n","changelog":"<h4>1.2.2<\/h4>\n<p>Add support for changing attachment attributes using <code>nmr_before_insert_attachment<\/code> filter<\/p>\n<h4>1.2.1<\/h4>\n<ul>\n<li>Added support for media uploads (including mp3)<\/li>\n<\/ul>\n<h4>1.2.0<\/h4>\n<ul>\n<li>Added filter <code>nmr_create_attachment_file_name<\/code> and action <code>nmr_create_attachment_id_generated<\/code><\/li>\n<\/ul>\n<h4>1.1.0<\/h4>\n<ul>\n<li>Contact Form 7 <code>WPCF7_Submission::get_instance()-&gt;uploaded_files<\/code> changed in CF7 5.4, so adjustments in this plugin were needed.<\/li>\n<\/ul>\n<h4>1.0.0<\/h4>\n<ul>\n<li>First version.<\/li>\n<\/ul>\n","screenshots":"<ol><li><a href=\"https:\/\/ps.w.org\/store-file-uploads-for-contact-form-7\/assets\/screenshot-1.jpg?rev=2251754\"><img src=\"https:\/\/ps.w.org\/store-file-uploads-for-contact-form-7\/assets\/screenshot-1.jpg?rev=2251754\" alt=\"screenshot-1.jpg\"><\/a><p>screenshot-1.jpg<\/p><\/li><\/ol>","reviews":"<div class=\"review\">\n\t<div class=\"review-head\">\n\t\t<div class=\"reviewer-info\">\n\t\t\t<div class=\"review-title-section\">\n\t\t\t\t<h4 class=\"review-title\">Thanks!<\/h4>\n\t\t\t\t<div class=\"star-rating\">\n\t\t\t\t<div class=\"wporg-ratings\" aria-label=\"5 out of 5 stars\" data-title-template=\"%s out of 5 stars\" data-rating=\"5\" style=\"color:#ffb900;\"><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><\/div>\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t<p class=\"reviewer\">\n\t\t\t\tBy <a href=\"https:\/\/profiles.wordpress.org\/benjamintoth\/\"><img alt='' src='https:\/\/secure.gravatar.com\/avatar\/9d18685280e94b68694247be775949a5?s=16&#038;d=monsterid&#038;r=g' srcset='https:\/\/secure.gravatar.com\/avatar\/9d18685280e94b68694247be775949a5?s=32&#038;d=monsterid&#038;r=g 2x' class='avatar avatar-16 photo' height='16' width='16' loading='lazy' decoding='async'\/><\/a><a href=\"https:\/\/profiles.wordpress.org\/benjamintoth\/\" class=\"reviewer-name\">benjamintoth<\/a> on <span class=\"review-date\">January 25, 2023<\/span>\t\t\t<\/p>\n\t\t<\/div>\n\t<\/div>\n\t<div class=\"review-body\"><!-- wp:paragraph -->\n<p>Works as expected out of the box. <\/p>\n<!-- \/wp:paragraph --><\/div>\n<\/div>\n<div class=\"review\">\n\t<div class=\"review-head\">\n\t\t<div class=\"reviewer-info\">\n\t\t\t<div class=\"review-title-section\">\n\t\t\t\t<h4 class=\"review-title\">Great plugin<\/h4>\n\t\t\t\t<div class=\"star-rating\">\n\t\t\t\t<div class=\"wporg-ratings\" aria-label=\"5 out of 5 stars\" data-title-template=\"%s out of 5 stars\" data-rating=\"5\" style=\"color:#ffb900;\"><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><\/div>\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t<p class=\"reviewer\">\n\t\t\t\tBy <a href=\"https:\/\/profiles.wordpress.org\/jakubborek\/\"><img alt='' src='https:\/\/secure.gravatar.com\/avatar\/4c94f70b8ab739377e4020504e25b8d6?s=16&#038;d=monsterid&#038;r=g' srcset='https:\/\/secure.gravatar.com\/avatar\/4c94f70b8ab739377e4020504e25b8d6?s=32&#038;d=monsterid&#038;r=g 2x' class='avatar avatar-16 photo' height='16' width='16' loading='lazy' decoding='async'\/><\/a><a href=\"https:\/\/profiles.wordpress.org\/jakubborek\/\" class=\"reviewer-name\">jakubborek<\/a> on <span class=\"review-date\">October 25, 2022<\/span>\t\t\t<\/p>\n\t\t<\/div>\n\t<\/div>\n\t<div class=\"review-body\">Solved my issue without problem, works fine from installation<\/div>\n<\/div>\n<div class=\"review\">\n\t<div class=\"review-head\">\n\t\t<div class=\"reviewer-info\">\n\t\t\t<div class=\"review-title-section\">\n\t\t\t\t<h4 class=\"review-title\">Getting Error Call to undefined function wp_read_audio_metadata<\/h4>\n\t\t\t\t<div class=\"star-rating\">\n\t\t\t\t<div class=\"wporg-ratings\" aria-label=\"5 out of 5 stars\" data-title-template=\"%s out of 5 stars\" data-rating=\"5\" style=\"color:#ffb900;\"><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><\/div>\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t<p class=\"reviewer\">\n\t\t\t\tBy <a href=\"https:\/\/profiles.wordpress.org\/mrkhanakia\/\"><img alt='' src='https:\/\/secure.gravatar.com\/avatar\/6e4384dd1244c3bca20143e7f08010a7?s=16&#038;d=monsterid&#038;r=g' srcset='https:\/\/secure.gravatar.com\/avatar\/6e4384dd1244c3bca20143e7f08010a7?s=32&#038;d=monsterid&#038;r=g 2x' class='avatar avatar-16 photo' height='16' width='16' loading='lazy' decoding='async'\/><\/a><a href=\"https:\/\/profiles.wordpress.org\/mrkhanakia\/\" class=\"reviewer-name\">mrkhanakia<\/a> on <span class=\"review-date\">December 2, 2021<\/span>\t\t\t<\/p>\n\t\t<\/div>\n\t<\/div>\n\t<div class=\"review-body\">I am getting error while submitting to CF7.\n\nNote: I am trying to upload MP3 files\n\n<pre><code>&lt;pre&gt;fatal error:\nArray\n(\n    [type] =&gt; 1\n    [message] =&gt; Uncaught Error: Call to undefined function wp_read_audio_metadata() in \/home\/theuxm\/html\/wp-admin\/includes\/image.php:489\nStack trace:\n#0 \/home\/theuxm\/html\/wp-content\/plugins\/store-file-uploads-for-contact-form-7\/store-file-uploads-for-contact-form-7.php(39): wp_generate_attachment_metadata()\n#1 \/home\/theuxm\/html\/wp-content\/plugins\/store-file-uploads-for-contact-form-7\/store-file-uploads-for-contact-form-7.php(55): nmr_create_attachment()\n#2 \/home\/theuxm\/html\/wp-includes\/class-wp-hook.php(305): nmr_on_before_cf7_send_mail()\n#3 \/home\/theuxm\/html\/wp-includes\/class-wp-hook.php(327): WP_Hook-&gt;apply_filters()\n#4 \/home\/theuxm\/html\/wp-includes\/plugin.php(518): WP_Hook-&gt;do_action()\n#5 \/home\/theuxm\/html\/wp-content\/plugins\/contact-form-7\/includes\/submission.php(617): do_action_ref_array()\n#6 \/home\/theuxm\/html\/wp-content\/plugins\/contact-form-7\/includes\/submission.php(86): WPCF7_Submission-&gt;before_send_mail()\n#7 \/home\/theuxm\/html\/wp-content\/plugins\/contact-form-7\/includes\/submission.php(27): WPCF7_Submission-&gt;proceed()\n#8\n    [file] =&gt; \/home\/theuxm\/html\/wp-admin\/includes\/image.php\n    [line] =&gt; 489\n)\n&lt;\/pre&gt;<\/code><\/pre>\n<\/div>\n<\/div>\n<div class=\"review\">\n\t<div class=\"review-head\">\n\t\t<div class=\"reviewer-info\">\n\t\t\t<div class=\"review-title-section\">\n\t\t\t\t<h4 class=\"review-title\">Works<\/h4>\n\t\t\t\t<div class=\"star-rating\">\n\t\t\t\t<div class=\"wporg-ratings\" aria-label=\"5 out of 5 stars\" data-title-template=\"%s out of 5 stars\" data-rating=\"5\" style=\"color:#ffb900;\"><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><\/div>\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t<p class=\"reviewer\">\n\t\t\t\tBy <a href=\"https:\/\/profiles.wordpress.org\/windseeking\/\"><img alt='' src='https:\/\/secure.gravatar.com\/avatar\/8a2ad36fd2b7e4ebdbf8e9a82ed7d3b2?s=16&#038;d=monsterid&#038;r=g' srcset='https:\/\/secure.gravatar.com\/avatar\/8a2ad36fd2b7e4ebdbf8e9a82ed7d3b2?s=32&#038;d=monsterid&#038;r=g 2x' class='avatar avatar-16 photo' height='16' width='16' loading='lazy' decoding='async'\/><\/a><a href=\"https:\/\/profiles.wordpress.org\/windseeking\/\" class=\"reviewer-name\">Inna Klementjeva <small>(windseeking)<\/small><\/a> on <span class=\"review-date\">July 19, 2021<\/span>\t\t\t<\/p>\n\t\t<\/div>\n\t<\/div>\n\t<div class=\"review-body\">It works and that's it<\/div>\n<\/div>\n<div class=\"review\">\n\t<div class=\"review-head\">\n\t\t<div class=\"reviewer-info\">\n\t\t\t<div class=\"review-title-section\">\n\t\t\t\t<h4 class=\"review-title\">Excellent<\/h4>\n\t\t\t\t<div class=\"star-rating\">\n\t\t\t\t<div class=\"wporg-ratings\" aria-label=\"5 out of 5 stars\" data-title-template=\"%s out of 5 stars\" data-rating=\"5\" style=\"color:#ffb900;\"><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><\/div>\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t<p class=\"reviewer\">\n\t\t\t\tBy <a href=\"https:\/\/profiles.wordpress.org\/alexwbaumann\/\"><img alt='' src='https:\/\/secure.gravatar.com\/avatar\/6ad03b88980fd7e6faa75f97633183e6?s=16&#038;d=monsterid&#038;r=g' srcset='https:\/\/secure.gravatar.com\/avatar\/6ad03b88980fd7e6faa75f97633183e6?s=32&#038;d=monsterid&#038;r=g 2x' class='avatar avatar-16 photo' height='16' width='16' loading='lazy' decoding='async'\/><\/a><a href=\"https:\/\/profiles.wordpress.org\/alexwbaumann\/\" class=\"reviewer-name\">alexwbaumann<\/a> on <span class=\"review-date\">March 3, 2021<\/span>\t\t\t<\/p>\n\t\t<\/div>\n\t<\/div>\n\t<div class=\"review-body\">Thanks! I spent a day wondering why the temporary file was not longer there then another day finding out that CF7 is moving that file. So this is exactly what I was trying to figure out. It does look like files could be overwritten if they are uploaded with an existing name. You can probably do something like the following to ensure files get unique names and are not overwritten.\n\n<pre><code>\/\/ Get the path to the upload directory.\n$wp_upload_dir = wp_upload_dir();\n$upload_path = $wp_upload_dir[&#039;path&#039;];\n\n$unique_filename = wp_unique_filename($upload_path, basename($filename));\n$attachFileName = $upload_path . &#039;\/&#039; . $unique_filename;\n\ncopy($filename, $attachFileName);\n\/\/ Prepare an array of post data for the attachment.\n$attachment = array(\n    &#039;guid&#039;           =&gt; $attachFileName,\n    &#039;post_mime_type&#039; =&gt; $filetype[&#039;type&#039;],\n    &#039;post_title&#039;     =&gt; preg_replace(&#039;\/\\.[^.]+$\/&#039;, &#039;&#039;, $unique_filename),\n    &#039;post_content&#039;   =&gt; &#039;&#039;,\n    &#039;post_status&#039;    =&gt; &#039;inherit&#039;\n);<\/code><\/pre>\n\n\n<\/div>\n<\/div>\n<div class=\"review\">\n\t<div class=\"review-head\">\n\t\t<div class=\"reviewer-info\">\n\t\t\t<div class=\"review-title-section\">\n\t\t\t\t<h4 class=\"review-title\">Works smoothly<\/h4>\n\t\t\t\t<div class=\"star-rating\">\n\t\t\t\t<div class=\"wporg-ratings\" aria-label=\"5 out of 5 stars\" data-title-template=\"%s out of 5 stars\" data-rating=\"5\" style=\"color:#ffb900;\"><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><span class=\"star dashicons dashicons-star-filled\"><\/span><\/div>\t\t\t\t<\/div>\n\t\t\t<\/div>\n\t\t\t<p class=\"reviewer\">\n\t\t\t\tBy <a href=\"https:\/\/profiles.wordpress.org\/agiannastasio\/\"><img alt='' src='https:\/\/secure.gravatar.com\/avatar\/98cc38f6b65e22639ab3d0c55e501b73?s=16&#038;d=monsterid&#038;r=g' srcset='https:\/\/secure.gravatar.com\/avatar\/98cc38f6b65e22639ab3d0c55e501b73?s=32&#038;d=monsterid&#038;r=g 2x' class='avatar avatar-16 photo' height='16' width='16' loading='lazy' decoding='async'\/><\/a><a href=\"https:\/\/profiles.wordpress.org\/agiannastasio\/\" class=\"reviewer-name\">agiannastasio<\/a> on <span class=\"review-date\">May 14, 2020<\/span>\t\t\t<\/p>\n\t\t<\/div>\n\t<\/div>\n\t<div class=\"review-body\">It works perfect, no config needed.<\/div>\n<\/div>\n"},"download_link":"https:\/\/downloads.wordpress.org\/plugin\/store-file-uploads-for-contact-form-7.1.2.2.zip","screenshots":{"1":{"src":"https:\/\/ps.w.org\/store-file-uploads-for-contact-form-7\/assets\/screenshot-1.jpg?rev=2251754","caption":"screenshot-1.jpg"}},"tags":{"contact":"contact","contact-form":"contact form","email":"email","feedback":"feedback","form":"form"},"versions":{"1.0.0":"https:\/\/downloads.wordpress.org\/plugin\/store-file-uploads-for-contact-form-7.1.0.0.zip","1.1.0":"https:\/\/downloads.wordpress.org\/plugin\/store-file-uploads-for-contact-form-7.1.1.0.zip","1.2.0":"https:\/\/downloads.wordpress.org\/plugin\/store-file-uploads-for-contact-form-7.1.2.0.zip","1.2.1":"https:\/\/downloads.wordpress.org\/plugin\/store-file-uploads-for-contact-form-7.1.2.1.zip","1.2.2":"https:\/\/downloads.wordpress.org\/plugin\/store-file-uploads-for-contact-form-7.1.2.2.zip","trunk":"https:\/\/downloads.wordpress.org\/plugin\/store-file-uploads-for-contact-form-7.zip"},"donate_link":"https:\/\/paypal.me\/mirceatm","banners":[]}